# Перекодировка текста

## Исходеик:
```
ОГЛАВЛЕН╤Е
ПЕРВОЙ ЧАСТИ.
  
   Глава I. Назначен╕е двухъ отрядовъ для изыскан╕й.-- Приготовлен╕е шлюповъ Востока и Мирнаго. -- Государь Императоръ изволилъ быть на шлюпахъ. -- Плаван╕е изъ Кронштата до Англ╕и
   II. Плаван╕е отъ Англ╕и до острова Тенерифа, потомъ до Р╕о Жанейро. -- Пребыван╕е въ Р╕о-Жанейро
   III. Отбыт╕е изъ Р╕о-Жанейро. -- Плаван╕е по Южную сторону острова Георг╕я. -- Обрѣтен╕е острововъ Маркиза де Траверсе. -- Плаван╕е по Восточную сторону Южныхъ Сандвичевыхъ острововъ. -- Плаван╕е въ Южномъ и Ледовитомъ Океанѣ. -- Прибыт╕е въ Портъ-Жаксонъ. -- Плаван╕е шлюпа Мирнаго во время разлуки съ шлюпомъ Востокомъ. -- Пребыван╕е въ Портъ-Жаксонѣ
   IV. Отбыт╕е изъ Портъ-Жаксона къ Новой Зеланд╕и.-- Пребыван╕е въ проливѣ Королевы Шарлоты. -- Плаван╕е въ Великомъ Океанѣ. -- Обрѣтен╕е острововъ Росс╕янъ. -- Прибыт╕е къ острову Отаити
```
* **Это выглядит как текст на дореволюционном русском языке с некорректно отображаемыми символами.**
* **Вот правильное преобразование:**
```
ОГЛАВЛЕНИЕ
ПЕРВОЙ ЧАСТИ.

   Глава I. Назначение двухъ отрядовъ для изысканій.-- Приготовление шлюповъ Востока и Мирнаго. -- Государь Императоръ изволилъ быть на шлюпахъ. -- Плавание изъ Кронштата до Англіи

   II. Плавание отъ Англіи до острова Тенерифа, потомъ до Ріо Жанейро. -- Пребывание въ Ріо-Жанейро

   III. Отбытіе изъ Ріо-Жанейро. -- Плавание по Южную сторону острова Георгія. -- Обрѣтеніе острововъ Маркиза де Траверсе. -- Плавание по Восточную сторону Южныхъ Сандвичевыхъ острововъ. -- Плавание въ Южномъ и Ледовитомъ Океанѣ. -- Прибытіе въ Портъ-Жаксонъ. -- Плавание шлюпа Мирнаго во время разлуки съ шлюпомъ Востокомъ. -- Пребывание въ Портъ-Жаксонѣ

   IV. Отбытіе изъ Портъ-Жаксона къ Новой Зеландіи.-- Пребывание въ проливѣ Королевы Шарлоты. -- Плавание въ Великомъ Океанѣ. -- Обрѣтеніе острововъ Россіянъ. -- Прибытіе къ острову Отаити
```
* **Я заменил символы:**
  * "╤" на "И", а символ
  * "╕" на "і" (десятеричное и),
  * что соответствует правилам дореволюционной орфографии.
  * Также исправил другие символы, которые были некорректно отображены.


## Скрипт для автоматического преобразования текста во всех книгах.
* **Вот решение на Python: fix_encoding.py**
```python
import os
import re

# Словарь замен для некорректных символов
replacements = {
    '╤': 'И',
    '╕': 'і',
    '╖': 'ѣ',  # если встречается
    '╗': 'ъ',  # если встречается
    # Добавьте другие замены по необходимости
}

def fix_text(text):
    """Исправляет некорректные символы в тексте"""
    for old, new in replacements.items():
        text = text.replace(old, new)
    return text

def process_file(file_path):
    """Обрабатывает один файл"""
    try:
        # Определяем кодировку файла (можно изменить если известна)
        encodings = ['utf-8', 'cp1251', 'koi8-r', 'iso-8859-5']
        
        for encoding in encodings:
            try:
                with open(file_path, 'r', encoding=encoding) as file:
                    content = file.read()
                    break
            except UnicodeDecodeError:
                continue
        else:
            print(f"Не удалось определить кодировку файла {file_path}")
            return
        
        # Исправляем текст
        fixed_content = fix_text(content)
        
        # Записываем исправленный текст
        with open(file_path, 'w', encoding='utf-8') as file:
            file.write(fixed_content)
        
        print(f"Обработан файл: {file_path}")
    except Exception as e:
        print(f"Ошибка при обработке файла {file_path}: {e}")

def process_directory(directory_path, extensions=['.txt']):
    """Обрабатывает все файлы в директории с указанными расширениями"""
    for root, _, files in os.walk(directory_path):
        for file in files:
            if any(file.lower().endswith(ext) for ext in extensions):
                file_path = os.path.join(root, file)
                process_file(file_path)

if __name__ == "__main__":
    import sys
    
    if len(sys.argv) < 2:
        print("Использование: python fix_encoding.py <путь_к_директории> [расширения_файлов]")
        print("Пример: python fix_encoding.py ./books txt,doc")
        sys.exit(1)
    
    directory = sys.argv[1]
    
    extensions = ['.txt']  # По умолчанию только текстовые файлы
    if len(sys.argv) > 2:
        extensions = ['.' + ext if not ext.startswith('.') else ext for ext in sys.argv[2].split(',')]
    
    print(f"Начинаю обработку файлов с расширениями {extensions} в директории {directory}")
    process_directory(directory, extensions)
    print("Обработка завершена")
```
* **Запустить скрипт можно так:**
```
python fix_encoding.py /путь/к/.../книгам txt
```
* **Если книги в других форматах, укажите их расширения через запятую:**
```
python fix_encoding.py /путь/к/.../книгам txt,doc,fb2
```